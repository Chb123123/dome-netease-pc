{"version":3,"file":"js/655.7ec30605.js","mappings":"imBA2BA,IAAIA,GAAYC,EAAAA,EAAAA,IAAI,IAEhBC,GAAUD,EAAAA,EAAAA,IAAI,IAEdE,GAAcF,EAAAA,EAAAA,KAAI,GAClBG,GAAWH,EAAAA,EAAAA,IAAI,SAEnB,MAAMI,GAAUC,EAAAA,EAAAA,MAChB,SAASC,IACO,KAAZL,GAAgC,KAAdF,GACpBQ,EAAAA,EAAAA,GAAM,CACLC,OAAQ,OACRC,IAAK,kBACLC,KAAM,CACLC,MAAOZ,EACPE,QAASA,KAERW,MAAMC,IACRC,QAAQC,IAAIF,EAAIH,MACM,MAAlBG,EAAIH,KAAKM,KACZZ,EAAQa,KAAK,KAEbC,EAAM,aACP,IAGDA,EAAM,eAER,CACA,SAASC,KACRZ,EAAAA,EAAAA,GAAM,CACLE,IAAK,iBACHG,MAAMC,IACmB,MAAvBA,EAAIH,KAAKA,KAAKM,MACjBF,QAAQC,IAAIF,EAAIH,KAAKA,KAAKU,SAE1BC,aAAaC,QAAQ,WAAYC,KAAKC,UAAUX,EAAIH,KAAKA,KAAKU,YAE9DF,IAEAG,aAAaI,WAAW,YACzB,GAEF,CACA,SAASP,IACRQ,EAAAA,GAAAA,MAAgB,iCACjB,CAEA,SAASC,IACS,KAAd5B,GACFQ,EAAAA,EAAAA,GAAM,CACLE,IAAK,uBAAyBV,IAI5Ba,MAAMC,IAGR,GAFAC,QAAQC,IAAIF,EAAIH,MAChBI,QAAQC,IAAIhB,GACS,MAAlBc,EAAIH,KAAKM,KAAc,CACzBd,EAAY0B,OAAQ,EACpB,IAAIC,EAAM,GACNC,EAAQC,aAAY,KACvBF,IACA1B,EAASyB,MAAQC,EAAM,OACZ,IAARA,IACF3B,EAAY0B,OAAQ,EACpBI,cAAcF,GACf,GACE,MACHJ,EAAAA,EAAAA,IAAU,CACTO,KAAM,UACNC,QAAS,iBAEX,MACCR,EAAAA,EAAAA,IAAU,CACTO,KAAM,QACNC,QAAS,kBAEX,IAGDhB,EAAM,UAER,CAEA,SAASiB,KACR5B,EAAAA,EAAAA,GAAM,CACLC,OAAQ,MACRC,IAAK,wBACHG,MAAKC,IACP,GAAqB,MAAlBA,EAAIH,KAAKM,KAAc,CACzB,IAAIoB,EAAW,CACdC,OAAQxB,EAAIH,KAAK2B,OACjBC,OAAQzB,EAAIH,KAAK4B,QAEfjB,aAAakB,QAAQ,aACvBlB,aAAaI,WAAW,YACxBJ,aAAaC,QAAQ,WAAYC,KAAKC,UAAUY,KAEhDf,aAAaC,QAAQ,WAAYC,KAAKC,UAAUY,IAGjDhC,EAAQa,KAAK,IACd,IAEF,CAEA,SAASuB,KACRjC,EAAAA,EAAAA,GAAM,CACLE,IAAK,kBACHG,MAAKC,IACPC,QAAQC,IAAIF,EAAIH,KAAKA,KAAK,GAE5B,C,OAECS,IACAqB,I,y3BCzID,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://demo-netease-pc/./src/views/login/index.vue","webpack://demo-netease-pc/./src/views/login/index.vue?b794"],"sourcesContent":["<template>\r\n\t<div class=\"container-main\">\r\n\t\t<div class=\"pageMain\">\r\n\t\t\t<div class=\"loginContent\">\r\n\t\t\t\t<h2 class=\"titleStyle\">登入</h2>\r\n\t\t\t\t<div class=\"inputStyle\">\r\n\t\t\t\t\t<span style=\"flex: 0.2; text-align: right; margin-right: 20px;\">输入手机号:</span>\r\n\t\t\t\t\t<el-input v-model=\"userPhone\" placeholder=\"请输入手机号\" />\r\n\t\t\t\t\t<el-button @click=\"getVerificationCode\" style=\"flex: 0.2;\" :disabled=\"btnIsUsable\">{{ btnValue }}</el-button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"inputStyle\">\r\n\t\t\t\t\t<el-input v-model=\"captcha\" placeholder=\"输入验证码\" />\r\n\t\t\t\t\t<el-button @click=\"getVerificationCode\">获取验证码</el-button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<el-button type=\"primary\" round @click=\"getLogin\">点击登入</el-button>\r\n\t\t\t\t<el-button type=\"primary\" round @click=\"visitorLogin\">游客登入</el-button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ElMessage } from \"element-plus\";\r\nimport { ref } from \"vue\";\r\nimport axios from \"@/util/require\";\r\nimport { useRouter } from 'vue-router'\r\n// 用户手机号\r\nlet userPhone = ref(\"\");\r\n// 通过手机号获取的验证码\r\nlet captcha = ref('')\r\n// 发送验证码按钮是否可用\r\nlet btnIsUsable = ref(false)\r\nlet btnValue = ref('获取验证码')\r\n\r\nconst $router = useRouter()\r\nfunction getLogin() {\r\n\tif(captcha !== '' && userPhone !== '') {\r\n\t\taxios({\r\n\t\t\tmethod: \"POST\",\r\n\t\t\turl: \"/captcha/verify\",\r\n\t\t\tdata: {\r\n\t\t\t\tphone: userPhone,\r\n\t\t\t\tcaptcha: captcha, // captcha 表示手机接收到的验证码\r\n\t\t\t},\r\n\t\t}).then((res) => {\r\n\t\t\tconsole.log(res.data);\r\n\t\t\tif (res.data.code === 200) {\r\n\t\t\t\t$router.push('/')\r\n\t\t\t} else {\r\n\t\t\t\topen2('验证失败,请重新输入')\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\topen2('手机号或验证码不能为空!')\r\n\t}\r\n}\r\nfunction getUserInfo() {\r\n\taxios({\r\n\t\turl: \"login/status\",\r\n\t}).then((res) => {\r\n\t\tif (res.data.data.code === 200) {\r\n\t\t\tconsole.log(res.data.data.account);\r\n\t\t\t// 将获取到用户信息保存到本地\r\n\t\t\tlocalStorage.setItem(\"userInfo\", JSON.stringify(res.data.data.account));\r\n\t\t} else {\r\n\t\t\topen2();\r\n\t\t\t// 当请求接口返回的状态码不为 200 时,删除本地存储的用户信息\r\n\t\t\tlocalStorage.removeItem(\"userInfo\");\r\n\t\t}\r\n\t});\r\n}\r\nfunction open2() {\r\n\tElMessage.error(\"Oops, this is a error message.\");\r\n}\r\n// 获取验证码\r\nfunction getVerificationCode() {\r\n\tif(userPhone !== \"\") {\r\n\t\taxios({\r\n\t\t\turl: \"/captcha/sent?phone=\" + userPhone,\r\n\t\t\t// params: {\r\n\t\t\t// \tphone: parseInt(userPhone),\r\n\t\t\t// },\r\n\t\t}).then((res) => {\r\n\t\t\tconsole.log(res.data);\r\n\t\t\tconsole.log(userPhone)\r\n\t\t\tif(res.data.code === 200) {\r\n\t\t\t\tbtnIsUsable.value = true\r\n\t\t\t\tlet num = 60\r\n\t\t\t\tlet timer = setInterval(() => {\r\n\t\t\t\t\tnum --\r\n\t\t\t\t\tbtnValue.value = num + '秒后重试'\r\n\t\t\t\t\tif(num === 0) {\r\n\t\t\t\t\t\tbtnIsUsable.value = false\r\n\t\t\t\t\t\tclearInterval(timer)\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 1000)\r\n\t\t\t\tElMessage({\r\n\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\tmessage: '发送验证码成功,注意查收!'\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tElMessage({\r\n\t\t\t\t\ttype: 'error',\r\n\t\t\t\t\tmessage: '发送验证码失败,请稍后重试!'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\topen2('请输入手机号!')\r\n\t}\r\n}\r\n// 游客登入\r\nfunction visitorLogin () {\r\n\taxios({\r\n\t\tmethod: 'get',\r\n\t\turl: '/register/anonimous'\r\n\t}).then(res => {\r\n\t\tif(res.data.code === 200) {\r\n\t\t\tlet userInfo = {\r\n\t\t\t\tuserId: res.data.userId,\r\n\t\t\t\tcookie: res.data.cookie\r\n\t\t\t}\r\n\t\t\tif(localStorage.getItem('userInfo')) {\r\n\t\t\t\tlocalStorage.removeItem('userInfo')\r\n\t\t\t\tlocalStorage.setItem('userInfo', JSON.stringify(userInfo))\r\n\t\t\t} else {\r\n\t\t\t\tlocalStorage.setItem('userInfo', JSON.stringify(userInfo))\r\n\t\t\t}\r\n\t\t\t// 跳转到首页\r\n\t\t\t$router.push('/')\r\n\t\t}\r\n\t})\r\n}\r\n// 监测登入状态\r\nfunction monitorLogin () {\r\n\taxios({\r\n\t\turl: '/login/status'\r\n\t}).then(res => {\r\n\t\tconsole.log(res.data.data)\r\n\t})\r\n}\r\ncreated: {\r\n\tgetUserInfo();\r\n\tmonitorLogin()\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.pageMain {\r\n\tposition: relative;\r\n\twidth: 100vw;\r\n\theight: calc(100vh - 20px);\r\n\tpadding: 20px;\r\n\t// 登入样式\r\n\t.loginContent {\r\n\t\tposition: absolute;\r\n\t\ttop: 50%;\r\n\t\tleft: 50%;\r\n\t\ttransform: translate(-50%, -50%);\r\n\t\tborder: 1px solid #ccc;\r\n\t\twidth: 600px;\r\n\t\theight: 400px;\r\n\t\t.titleStyle {\r\n\t\t\tpadding: 30px 20px;\r\n\t\t\tfont-weight: 800;\r\n\t\t}\r\n\t\t// 输入框样式\r\n\t\t.inputStyle {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: center;\r\n\t\t\theight: 70px;\r\n\t\t\twidth: 100%;\r\n\t\t\tpadding: 0 30px;\r\n\t\t\tmargin-bottom: 30px;\r\n\t\t\t.el-input{\r\n\t\t\t\tflex: 0.7;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</style>\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=388c50ac&lang=scss&scoped=true\"\n\nimport exportComponent from \"D:\\\\demo\\\\网易云音乐\\\\demo-netease-pc\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-388c50ac\"]])\n\nexport default __exports__"],"names":["userPhone","ref","captcha","btnIsUsable","btnValue","$router","useRouter","getLogin","axios","method","url","data","phone","then","res","console","log","code","push","open2","getUserInfo","account","localStorage","setItem","JSON","stringify","removeItem","ElMessage","getVerificationCode","value","num","timer","setInterval","clearInterval","type","message","visitorLogin","userInfo","userId","cookie","getItem","monitorLogin","__exports__"],"sourceRoot":""}